include ../.makefiles

all:
	@echo "Syntax: make <test|prepare|jar|clean>"

test:
	@(make clean v=$(VER))
	@(make prepare v=$(VER))
	(cd $(SRC)/com/qzx/au/$(MOD) ; export CLASSPATH=$(CPCOMMON):$(CP) ; $(JC) $(JFLAGS) *.java)

prepare:
	@mkdir -p $(SRC)/com/qzx/au/$(MOD)
	@(cd src; for j in *.java; do cpp -E -P -DMC$(VER) -o $(SRC)/com/qzx/au/$(MOD)/$$j $$j; done)
	@(cd src; for d in *; do if [ -d "$$d" ]; then mkdir $(SRC)/com/qzx/au/$(MOD)/$$d; for j in $$d/*.java; do cpp -E -P -DMC$(VER) -o $(SRC)/com/qzx/au/$(MOD)/$$j $$j; done; fi; done)

clean:
	rm -f au_$(MOD)-*.zip *.class
	rm -rf com mods
